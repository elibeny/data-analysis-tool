<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'; connect-src 'self';">
    <title>Data Analysis Tool</title>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="assets/fontawesome/css/all.min.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="app" class="container">
        <!-- Header Section -->
        <div class="header">
            <h1>Data Analysis Tool</h1>
            <p>Powerful tools for data scaling and word frequency analysis</p>
        </div>

        <!-- Project Selection -->
        <div id="projectSelection" class="project-section">
            <div class="row">
                <div class="col-md-6 mb-4">
                    <div class="card project-card h-100" @click="selectProject('dataScaling')">
                        <div class="card-body text-center">
                            <div class="project-icon">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <h3 class="card-title">Data Scaling</h3>
                            <p class="card-text">Upload your data file to process, scale, and analyze values across groups and posts.</p>
                            <button class="btn btn-primary mt-3">
                                <i class="fas fa-arrow-right"></i> Get Started
                            </button>
                        </div>
                    </div>
                </div>
                <div class="col-md-6 mb-4">
                    <div class="card project-card h-100" @click="selectProject('wordCounter')">
                        <div class="card-body text-center">
                            <div class="project-icon">
                                <i class="fas fa-font"></i>
                            </div>
                            <h3 class="card-title">Word Frequency</h3>
                            <p class="card-text">Analyze text to identify and visualize the most frequently occurring words.</p>
                            <button class="btn btn-primary mt-3">
                                <i class="fas fa-arrow-right"></i> Get Started
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Data Scaling Section -->
        <div id="dataScaling" class="project-section">
            <a href="#" class="back-link" @click="goBackToSelection">
                <i class="fas fa-arrow-left"></i> Back to Projects
            </a>
            <div class="card">
                <div class="card-header">
                    <h3>Data Scaling</h3>
                </div>
                <div class="card-body">
                    <p>Upload your data file to process and scale values across groups and posts.</p>
                    <form @submit.prevent="uploadAndProcess">
                        <div class="mb-3">
                            <label for="file" class="form-label">Select File (Excel or CSV)</label>
                            <input type="file" class="form-control" id="file" accept=".xlsx,.xls,.csv" required>
                            <div class="form-text">File should contain columns for group, post, valence, and arousal.</div>
                        </div>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-upload"></i> Upload and Process
                        </button>
                    </form>
                </div>
            </div>
            
            <div id="scalingResults" style="display: none;">
                <div class="card mt-4">
                    <div class="card-header">
                        <h3>Results</h3>
                    </div>
                    <div class="card-body">
                        <p id="scalingSummary"></p>
                        
                        <!-- Dataset Preview Tabs -->
                        <ul class="nav nav-tabs mb-3" id="datasetTabs" role="tablist">
                            <!-- Tabs will be generated dynamically -->
                        </ul>
                        
                        <!-- Dataset Preview Content -->
                        <div class="tab-content" id="datasetTabsContent">
                            <!-- Tab content will be generated dynamically -->
                        </div>
                        
                        <!-- Download Options -->
                        <div class="mt-4">
                            <h4>Download Options</h4>
                            <div class="row download-options">
                                <div class="col-md-4 mb-3" v-for="(url, filename) in dataframes">
                                    <div class="card h-100">
                                        <div class="card-body d-flex flex-column">
                                            <h5 class="card-title">{{ getDatasetTitle(filename) }}</h5>
                                            <p class="card-text">{{ getDatasetDescription(filename) }}</p>
                                            <button class="btn btn-primary mt-auto" @click="downloadData(url, filename)">
                                                <i class="fas fa-download"></i> Download
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Word Counter Section -->
        <div id="wordCounter" class="project-section">
            <a href="#" class="back-link" @click="goBackToSelection">
                <i class="fas fa-arrow-left"></i> Back to Projects
            </a>
            <div class="card">
                <div class="card-header">
                    <h3>Word Frequency Analyzer</h3>
                </div>
                <div class="card-body">
                    <p>Enter text to analyze word frequency and generate a visualization.</p>
                    <form @submit.prevent="analyzeText">
                        <div class="mb-3">
                            <label for="text" class="form-label">Enter Text</label>
                            <textarea class="form-control" id="text" rows="6" required></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-search"></i> Analyze Text
                        </button>
                    </form>
                </div>
            </div>
            
            <div id="wordCounterResults" style="display: none;">
                <div class="card mt-4">
                    <div class="card-header">
                        <h3>Word Frequency Results</h3>
                    </div>
                    <div class="card-body">
                        <div id="wordFrequencyChart" style="height: 400px;"></div>
                        <div class="mt-4 text-center">
                            <button class="btn btn-outline-primary me-2" @click="downloadWordFrequencyChart">
                                <i class="fas fa-image"></i> Download Chart as Image
                            </button>
                            <button class="btn btn-outline-primary" @click="downloadWordFrequencyResults">
                                <i class="fas fa-file-csv"></i> Download Results (CSV)
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Loading Spinner -->
        <div class="loading" style="display: none;">
            <div class="spinner-border" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
        </div>
    </div>

    <!-- Firebase App (the core Firebase SDK) -->
    <script src="assets/firebase/firebase-app-compat.js"></script>
    <!-- Firebase Functions -->
    <script src="assets/firebase/firebase-functions-compat.js"></script>
    <!-- Firebase Storage -->
    <script src="assets/firebase/firebase-storage-compat.js"></script>
    <!-- Firebase Config -->
    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBmNSa2Wd_RuUTVsX3G9o9RKqN9CnQ9nnc",
            authDomain: "data-analysis-tool-8c8c8.firebaseapp.com",
            projectId: "data-analysis-tool-8c8c8",
            storageBucket: "data-analysis-tool-8c8c8.appspot.com",
            messagingSenderId: "123456789012",
            appId: "1:123456789012:web:abcdef1234567890abcdef"
        };
        
        // Initialize Firebase
        try {
            firebase.initializeApp(firebaseConfig);
            console.log("Firebase initialized successfully");
        } catch (error) {
            console.error("Firebase initialization error:", error);
        }
    </script>
    <!-- Vue.js -->
    <script src="assets/vue/vue.global.js"></script>
    <!-- Plotly.js -->
    <script src="assets/plotly/plotly.min.js"></script>
    <!-- Bootstrap JS -->
    <script src="assets/bootstrap/js/bootstrap.bundle.min.js"></script>
    <!-- Custom JS -->
    <script src="app.js"></script>
</body>
</html>
